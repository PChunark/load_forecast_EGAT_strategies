# VSPP calculation


Estimated electricity generation (energy) can be in equation \@ref(eq:totVSPPEnergy). 


In this project, VSPP contract capacity and electricity generation are considered. An information is taken from **PDP2018 Rev.1** and **PDP2022 Case 7**. VSPP contract capacity and electricity generation are summarized by Power Development Planning Section (แผนกวางแผนพัฒนากำลังผลิตไฟฟ้า (หผฟ-ย.)), Generation System Development Planning Department (กองวางแผนพัฒนากำลังผลิตไฟฟ้า (กผฟ-ย.)), Generation and Transmission System Planning Division (ฝ่ายวางแผนระบบไฟฟ้า (อผฟ.)).

## VSPP in the PDP2018 revision 1 (PDP2018 Rev.1)

The summary of VSPP contract capacity and electricity generation is given by Power Development Planning Section. The R code chunk is given below.

```{r,vsppcontractcapPDP2018R1, echo=TRUE, warning=FALSE,message=FALSE}
vsppcontractcapPDP2018R1 <-
  
  read_excel("raw_data/Domeสรุป VSPP_PDP18R1 and ร่าง PDP2022 เคส 7_เพิ่ม vspp.xlsx",
              sheet = "สรุป VSPP PDP18R1 Fuel",
              range = "A1:U13")%>%
  rename(vspp_mw = "VSPP (MW)") %>% 
  pivot_longer(-vspp_mw, names_to = "year_th",values_to = "contract_mw") %>% 
  mutate(year = as.numeric(year_th)-543) %>%
  pivot_wider(names_from = vspp_mw, values_from = contract_mw) %>% 
  rename_all(tolower) %>% 
  rename(ind_waste = "industrial waste",
         total = "รวม") %>% 
  pivot_longer(-year_th&-year, names_to = "fuel",values_to = "contract_mw") 
```


**Coal and diesel** contract capacities are constant throughout PDP2018 rev.1 at **31.99 MW** and **29.98 MW**, respectively. Contract capacity from **gas** increases from **24.7 MW** in 2018 to **31.5 MW** in 2019 and remains constant till 2037. **Biogas** and **biomass** substantially increases from 2018-2037. In 2037, **biogas**, **biomass**, **solar** and **wind** contract capacity reach **1,535.48 MW** and **3,887.27 MW**, **11,574.56 MW**, and **1,541.37 MW**, respectively. Industrial waste starts from **5.91 MW** in 2034 to **44 MW** in 2037. Waste contract capacity reach **601 MW** from 2022 till 2037. Hydro power plant remain the same at **27.03 MW** from 2018-2037. **Energy efficiency plan (EE)** increases **354 MW** in 2032 and reaches **4,000 MW** in 2037. Total contract capacity increases from **3,787.48 MW** in 2018 to **23,304.21 MW** in 2037.


```{r plot-vsppConCapPDP2018r1, echo=FALSE, warning=FALSE, message=FALSE, fig.cap='VSPP contract capacity in the PDP2018 Rev.1', fig.align='center', out.width= '90%'}
vsppcontractcapPDP2018R1 %>%
  mutate(fuel = factor(fuel, c("coal", "diesel", "gas", "biogas", "biomass", "ind_waste", "waste", "hydro", "solar", "wind", "ee", "total"))) %>%
  ggplot(aes(x = year, y = contract_mw, group = fuel, color = fuel)) +
  geom_line(show.legend = FALSE)+
  facet_wrap(~fuel, 
             scales = "free_y",
             labeller = as_labeller(c(coal = "Coal",
                                      diesel = "Diesel",
                                      gas = "Gas",
                                      biogas = "Biogas",
                                      biomass = "Biomass",
                                      ind_waste = "Industrial waste",
                                      waste = "Waste",
                                      hydro = "Hydro",
                                      solar = "Solar",
                                      wind = "Wind",
                                      ee = "EE",
                                      total = "Total cont. cap.")))+
  ThemeLine +
  scale_x_continuous(breaks = c(2018,2023,2030,2037))+
  scale_y_continuous(labels =  comma)+ # Add comma to number in y axis
  labs(x = NULL,
       y = "Contract capacity (MW)")
```


Electricity generation from VSPP in the PDP2018 Rev.1 code chunk is provided below.

```{r , vsppenepdp2018r1, echo=TRUE, warning=FALSE, message=FALSE}
vsppenergyPDP2018R1 <-
  read_excel("raw_data/Domeสรุป VSPP_PDP18R1 and ร่าง PDP2022 เคส 7_เพิ่ม vspp.xlsx",
             sheet = "สรุป VSPP PDP18R1 Fuel",
             range = "A16:U28")%>%
  rename(vspp_gwh = "VSPP (Energy)") %>% 
  pivot_longer(-vspp_gwh, names_to = "year_th",values_to = "energy_gwh") %>% 
  mutate(year = as.numeric(year_th)-543) %>%
  pivot_wider(names_from = vspp_gwh, values_from = energy_gwh) %>% 
  rename_all(tolower) %>% 
  rename(ind_waste = "industrial waste",
         total = "รวม") %>% 
  pivot_longer(-year_th&-year, names_to = "fuel",values_to = "vspp_gwh")
```

Total electricity generation from VSPP increases from **9,070.21 GWh** in 2018 to **75,577.09 GWh** in 2037. Electricity generation from **coal**, **diesel** and **gas** are at **69 GWh**, **50 GWh** and **70 GWh** in 2037. **Biogas** and **biomass** contribute significantly surge an electricity generation to **7,994.75 GWh** and **23,226.09 GWh** in 2037. **Industrial waste** provides an electricity to the system since 2034. The generation reaches **269.81 GWh** in 2037. Waste power plant reaches its peak generation at **2,316.48 GWh** since 2022. Electricity generation from **small hydro power plant** remains constant at **78.99 GWh**. **Solar** and **wind** electricity significantly rise to **17,650.47 GWh** and **3,353.10 GWh** in 2037, respectively. Additional energy efficiency plan increase to **20,498.40 GWh** in 2037. 

```{r plot-vsppEnePDP2018r1, echo=FALSE, warning=FALSE, message=FALSE, fig.cap='VSPP electricity generation in the PDP2018 Rev.1', fig.align='center', out.width= '90%'}
vsppenergyPDP2018R1 %>% 
  mutate(fuel = factor(fuel, c("coal", "diesel", "gas", "biogas", "biomass", "ind_waste", "waste", "hydro", "solar", "wind", "ee", "total"))) %>% 
    ggplot(aes(x = year, y = vspp_gwh, group = fuel, color = fuel)) +
  geom_line(show.legend = FALSE)+
  facet_wrap(~fuel, 
             scales = "free_y",
             labeller = as_labeller(c(coal = "Coal",
                                      diesel = "Diesel",
                                      gas = "Gas",
                                      biogas = "Biogas",
                                      biomass = "Biomass",
                                      ind_waste = "Industrial waste",
                                      waste = "Waste",
                                      hydro = "Hydro",
                                      solar = "Solar",
                                      wind = "Wind",
                                      ee = "EE",
                                      total = "Total ely. gen.")))+
  ThemeLine +
  scale_x_continuous(breaks = c(2018,2023,2030,2037))+
  scale_y_continuous(labels =  comma)+ # Add comma to number in y axis
  labs(x = NULL,
       y = "Electricity generation (GWh)")
```

