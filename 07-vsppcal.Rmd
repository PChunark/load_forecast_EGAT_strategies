# VSPP calculation


Estimated electricity generation (energy) can be in equation (@\ref(eq:totVSPPEnergy)). 


In this project, VSPP contract capacity and electricity generation are considered. An information is taken from **PDP2018 Rev.1** and **PDP2022 Case 7**. VSPP contract capacity and electricity generation are summarized by Power Development Planning Section (แผนกวางแผนพัฒนากำลังผลิตไฟฟ้า (หผฟ-ย.)), Generation System Development Planning Department (กองวางแผนพัฒนากำลังผลิตไฟฟ้า (กผฟ-ย.)), Generation and Transmission System Planning Division (ฝ่ายวางแผนระบบไฟฟ้า (อผฟ.)). The R code chunk is given below. 


```{r,vsppcontractcapPDP2018R1, echo=TRUE, warning=FALSE,message=FALSE}
vsppcontractcapPDP2018R1 <-
  
  read_excel("raw_data/Domeสรุป VSPP_PDP18R1 and ร่าง PDP2022 เคส 7_เพิ่ม vspp.xlsx",
              sheet = "สรุป VSPP PDP18R1 Fuel",
              range = "A1:U13")%>%
  rename(vspp_mw = "VSPP (MW)") %>% 
  pivot_longer(-vspp_mw, names_to = "year_th",values_to = "contract_mw") %>% 
  mutate(year = as.numeric(year_th)-543) %>%
  pivot_wider(names_from = vspp_mw, values_from = contract_mw) %>% 
  rename_all(tolower) %>% 
  rename(ind_waste = "industrial waste",
         total = "รวม") %>% 
  pivot_longer(-year_th&-year, names_to = "fuel",values_to = "contract_mw") 
```
Coal and diesel contract capacities are constant throughout PDP2018 rev.1 at **31.99 MW** and **29.98 MW**, respectively. Contract capacity from gas increases from **24.7 MW** in 2018 to **31.5 MW** in 2019 and remains constant till 2037.  


```{r plot-vsppConCapPDP2018r1, echo=FALSE, warning=FALSE, message=FALSE, fig.cap='VSPP contract capacity in PDP2018 Rev.1', fig.align='center', out.width= '90%'}
vsppcontractcapPDP2018R1 %>%
  mutate(fuel = factor(fuel, c("coal", "diesel", "gas", "biogas", "biomass", "ind_waste", "waste", "hydro", "solar", "wind", "ee", "total"))) %>%
  ggplot(aes(x = year, y = contract_mw, group = fuel, color = fuel)) +
  geom_line(show.legend = FALSE)+
  facet_wrap(~fuel, 
             scales = "free_y",
             labeller = as_labeller(c(coal = "Coal",
                                      diesel = "Diesel",
                                      gas = "Gas",
                                      biogas = "Biogas",
                                      biomass = "Biomass",
                                      ind_waste = "Industrial waste",
                                      waste = "Waste",
                                      hydro = "Hydro",
                                      solar = "Solar",
                                      wind = "Wind",
                                      ee = "EE",
                                      total = "Total cont. cap.")))+
  ThemeLine +
  scale_x_continuous(breaks = c(2018,2023,2030,2037))+
  scale_y_continuous(labels =  comma)+ # Add comma to number in y axis
  labs(x = NULL,
       y = "VSPP contract capacity (MW)")
```

