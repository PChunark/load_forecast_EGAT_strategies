# VSPPs calculation


Estimated electricity generation (energy) can be found in equation \@ref(eq:totVSPPEnergy). 


In this project, VSPP contract capacity and electricity generation are considered. An information is taken from **PDP2018 Rev.1** and **PDP2022 Case 7**. VSPP contract capacity and electricity generation are summarized by Power Development Planning Section (แผนกวางแผนพัฒนากำลังผลิตไฟฟ้า (หผฟ-ย.)), Generation System Development Planning Department (กองวางแผนพัฒนากำลังผลิตไฟฟ้า (กผฟ-ย.)), Generation and Transmission System Planning Division (ฝ่ายวางแผนระบบไฟฟ้า (อผฟ.)).

## VSPPs in the PDP2018 revision 1 (PDP2018 Rev.1)
### Contract capacity

The summary of VSPP contract capacity and electricity generation is given by Power Development Planning Section. The R code chunk is given below.

```{r,vsppcontractcapPDP2018R1, echo=TRUE, warning=FALSE,message=FALSE}
vsppcontractcapPDP2018R1 <-
  
  read_excel("raw_data/Domeสรุป VSPP_PDP18R1 and ร่าง PDP2022 เคส 7_เพิ่ม vspp.xlsx",
              sheet = "สรุป VSPP PDP18R1 Fuel",
              range = "A1:U13")%>%
  rename(vspp_mw = "VSPP (MW)") %>% 
  pivot_longer(-vspp_mw, names_to = "year_th",values_to = "contract_mw") %>% 
  mutate(year = as.numeric(year_th)-543) %>%
  pivot_wider(names_from = vspp_mw, values_from = contract_mw) %>% 
  rename_all(tolower) %>% 
  rename(ind_waste = "industrial waste",
         total = "รวม") %>% 
  pivot_longer(-year_th&-year, names_to = "fuel",values_to = "contract_mw") 
```


**Coal and diesel** contract capacities are constant throughout PDP2018 rev.1 at **31.99 MW** and **29.98 MW**, respectively. Contract capacity from **gas** increases from **24.7 MW** in 2018 to **31.5 MW** in 2019 and remains constant till 2037. **Biogas** and **biomass** substantially increase from 2018-2037. In 2037, **biogas**, **biomass**, **solar** and **wind** contract capacity reach **1,535.48 MW** and **3,887.27 MW**, **11,574.56 MW**, and **1,541.37 MW**, respectively. Industrial waste starts from **5.91 MW** in 2034 to **44 MW** in 2037. Waste contract capacity reaches **601 MW** from 2022 till 2037. Hydro power plant remains the same at **27.03 MW** from 2018-2037. **Energy efficiency plan (EE)** increases **354 MW** in 2032 and reaches **4,000 MW** in 2037. Total contract capacity increases from **3,787.48 MW** in 2018 to **23,304.21 MW** in 2037.


```{r plot-vsppConCapPDP2018r1, echo=FALSE, warning=FALSE, message=FALSE, fig.cap='VSPP contract capacity in the PDP2018 Rev.1', fig.align='center', out.width= '90%'}
vsppcontractcapPDP2018R1 %>%
  mutate(fuel = factor(fuel, c("coal", "diesel", "gas", "biogas", "biomass", "ind_waste", "waste", "hydro", "solar", "wind", "ee", "total"))) %>%
  ggplot(aes(x = year, y = contract_mw, group = fuel, color = fuel)) +
  geom_line(show.legend = FALSE)+
  facet_wrap(~fuel, 
             scales = "free_y",
             labeller = as_labeller(c(coal = "Coal",
                                      diesel = "Diesel",
                                      gas = "Gas",
                                      biogas = "Biogas",
                                      biomass = "Biomass",
                                      ind_waste = "Ind. waste",
                                      waste = "Waste",
                                      hydro = "Hydro",
                                      solar = "Solar",
                                      wind = "Wind",
                                      ee = "EE",
                                      total = "Total cont. cap.")))+
  ThemeLine +
  scale_x_continuous(breaks = c(2018,2023,2030,2037))+
  scale_y_continuous(labels =  comma)+ # Add comma to number in y axis
  labs(x = NULL,
       y = "Contract capacity (MW)")
```

### Electricity generation {#vsppenergyPDP2018R1}


Electricity generation from VSPP in the PDP2018 Rev.1 code chunk is provided below.

```{r , vsppenepdp2018r1, echo=TRUE, warning=FALSE, message=FALSE}
vsppenergyPDP2018R1 <-
  read_excel("raw_data/Domeสรุป VSPP_PDP18R1 and ร่าง PDP2022 เคส 7_เพิ่ม vspp.xlsx",
             sheet = "สรุป VSPP PDP18R1 Fuel",
             range = "A16:U28")%>%
  rename(vspp_gwh = "VSPP (Energy)") %>% 
  pivot_longer(-vspp_gwh, names_to = "year_th",values_to = "energy_gwh") %>% 
  mutate(year = as.numeric(year_th)-543) %>%
  pivot_wider(names_from = vspp_gwh, values_from = energy_gwh) %>% 
  rename_all(tolower) %>% 
  rename(ind_waste = "industrial waste",
         total = "รวม") %>% 
  pivot_longer(-year_th&-year, names_to = "fuel",values_to = "vspp_gwh")
```

Total electricity generation from VSPP increases from **9,070.21 GWh** in 2018 to **75,577.09 GWh** in 2037. Electricity generation from **coal**, **diesel** and **gas** are at **69 GWh**, **50 GWh** and **70 GWh** in 2037. **Biogas** and **biomass** significantly surge an electricity generation to **7,994.75 GWh** and **23,226.09 GWh** in 2037, respectively. **Industrial waste** provides an electricity to the system since 2034. The generation reaches **269.81 GWh** in 2037. Waste power plant reaches its peak generation at **2,316.48 GWh** since 2022. Electricity generation from **small hydro power plant** remains constant at **78.99 GWh**. **Solar** and **wind** electricity significantly rise to **17,650.47 GWh** and **3,353.10 GWh** in 2037, respectively. Additional energy efficiency plan increases to **20,498.40 GWh** in 2037. 

```{r plot-vsppEnePDP2018r1, echo=FALSE, warning=FALSE, message=FALSE, fig.cap='VSPP electricity generation in the PDP2018 Rev.1', fig.align='center', out.width= '90%'}
vsppenergyPDP2018R1 %>% 
  mutate(fuel = factor(fuel, c("coal", "diesel", "gas", "biogas", "biomass", "ind_waste", "waste", "hydro", "solar", "wind", "ee", "total"))) %>% 
    ggplot(aes(x = year, y = vspp_gwh, group = fuel, color = fuel)) +
  geom_line(show.legend = FALSE)+
  facet_wrap(~fuel, 
             scales = "free_y",
             labeller = as_labeller(c(coal = "Coal",
                                      diesel = "Diesel",
                                      gas = "Gas",
                                      biogas = "Biogas",
                                      biomass = "Biomass",
                                      ind_waste = "Ind. waste",
                                      waste = "Waste",
                                      hydro = "Hydro",
                                      solar = "Solar",
                                      wind = "Wind",
                                      ee = "EE",
                                      total = "Total ely. gen.")))+
  ThemeLine +
  scale_x_continuous(breaks = c(2018,2023,2030,2037))+
  scale_y_continuous(labels =  comma)+ # Add comma to number in y axis
  labs(x = NULL,
       y = "Electricity generation (GWh)")
```

## VSPP in the PDP2022 Case 7
### Contract capacity

The summary of VSPP contract capacity is given by Power Development Planning Section. The R code chunk is given below. 

```{r vsppcontractcapPDP2022C7, echo=TRUE, warning=FALSE, message=FALSE}
vsppcontractcapPDP2022C7<-
  
  read_excel("raw_data/Domeสรุป VSPP_PDP18R1 and ร่าง PDP2022 เคส 7_เพิ่ม vspp.xlsx",
           sheet = "สรุป VSPP PDP2022 Fuel",
           range = "A1:Q23")%>%
  rename(vspp_mw = "VSPP-Contract Capacity") %>% 
  pivot_longer(-vspp_mw, names_to = "year",values_to = "contract_mw") %>% 
  mutate(year_th = as.numeric(year)+543) %>%
  pivot_wider(names_from = vspp_mw, values_from = contract_mw) %>% 
  rename_all(tolower) %>% 
  pivot_longer(-year_th&-year, names_to = "fuel",values_to = "vspp_mw") #%>% 
  # ggplot(aes(x = as.factor(year), y = vspp_mw, group = fuel, color = fuel)) + 
  # geom_line()
```


**Total contract capacity** increases from **4,329.68 MW** in 2022 to **15,393.37 MW** in 2037. **Coal**, **diesel**, **gas** and **waste heat** contract capacity remain the same in the PDP2022 case 7. The contract capacity are **43.79 MW**, **28.44 MW**, **24.70 MW** and **4.5 MW**. **Biogas** and **biomass** rapidly increase from 2025 and reach **1,481.97 MW** and **2,252.58 MW** in 2037, respectively. **Solar** contract capacity rises to **10,150 MW**. **Floating solar** starts to play its role since 2025. The capacity is **63.43 MW** in 2037. **Wind capacity** remains constant at **58.39 MW** during 2024-2037. **Small hydro** power plant contract capacity continuously rises from **58.59 MW** in 2022 to **126.22 MW** in 2037. **Geothermal** capacity is **21 MW** in 2037. **MSW** contract capacity escalates in **3 periods**. It starts from **179.56 MW in 2022**. The capacity increases to **595.56 MW** during 2026-2030, **795 MW** from 2031-2034, **895.56** MW from 2035 onwards. **Industrial waste** capacity remains **30.78 MW** from 2022-2025. The capacity reaches **242.78 MW** in 2037. 

```{r plot-vsppcontractcapPDP2022C7, echo=FALSE, warning=FALSE, message=FALSE, fig.cap='VSPP contract capacity in the PDP2022 case 7', fig.align='center', out.width= '90%'}
vsppcontractcapPDP2022C7 %>%
  filter(!(fuel %in% c("coal (lignite)", "dr", "fuel oil", "hydro (large)", "hydro (pump)", "import (hydro)", "import (interconnection)", "import (lignite)"))) %>%
  mutate(fuel = factor(fuel, c("coal", "diesel", "gas", "biogas", "biomass", "solar", "solar floating", "wind", "hydro (small)","geothermal", "msw", "wasteheat", "iew", "total"))) %>% 
  ggplot(aes(x = year, y = vspp_mw, group = fuel, color = fuel)) +
  geom_line(show.legend = FALSE)+
  facet_wrap(~fuel, 
             scales = "free_y",
             labeller = as_labeller(c(coal = "Coal",
                                      diesel = "Diesel",
                                      gas = "Gas",
                                      biogas = "Biogas",
                                      biomass = "Biomass",
                                      solar = "Solar",
                                      "solar floating" = "Solar floating",
                                      wind = "Wind",
                                      "hydro (small)" = "Small hydro",
                                      geothermal = "Geothermal",
                                      msw = "MSW",
                                      wasteheat = "Waste heat",
                                      iew = "Ind. waste",
                                      total = "Total cont. cap.")))+
  ThemeLine +
  scale_x_discrete(breaks = c(2022,2025,2030,2037))+
  scale_y_continuous(labels =  comma)+ # Add comma to number in y axis
  labs(x = NULL,
       y = "Contract capacity (MW)")
```
### Electricity generation
The summary of VSPP electricity generation is given by Power Development Planning Section. The R code chunk is given below.
```{r vsppenergyPDP2022C7, echo=TRUE, warning=FALSE, message=FALSE}
vsppenergyPDP2022C7 <-
  
  read_excel("raw_data/Domeสรุป VSPP_PDP18R1 and ร่าง PDP2022 เคส 7_เพิ่ม vspp.xlsx",
             sheet = "สรุป VSPP PDP2022 Fuel",
             range = "A25:Q47")%>%
  rename(vspp_gwh = "VSPP-Generation") %>% 
  pivot_longer(-vspp_gwh, names_to = "year",values_to = "energy_gwh") %>% 
  mutate(year_th = as.numeric(year)+543) %>%
  pivot_wider(names_from = vspp_gwh, values_from = energy_gwh) %>% 
  rename_all(tolower) %>% 
  pivot_longer(-year_th&-year, names_to = "fuel",values_to = "vspp_gwh")
```



**Total electricity generation** increases from **11,882.25 GWh** in 2022 to **42,213.86 GWh** in 2037. Electricity generation from **solar, biomass and biogas** are the top 3 contributors. In 2037, electricity generation from those 3 contributors are **16,128.4 GWh**, **12,577.94 GWh** and **7,771.70 GWh**. Floating solar and wind electricity generate **100 GWh** and **84.16 GWh**, respectively. MSW electricity generates **3,698 GWh**. Coal, diesel, gas generate **138.44 GWh**.

```{r plot-vsppenergyPDP2022C7, echo=FALSE, warning=FALSE, message=FALSE, fig.cap='VSPP electricity generation in the PDP2022 case 7', fig.align='center', out.width= '90%'}
vsppenergyPDP2022C7 %>%
  filter(!(fuel %in% c("coal (lignite)", "dr", "fuel oil", "hydro (large)", "hydro (pump)", "import (hydro)", "import (interconnection)", "import (lignite)"))) %>%
  mutate(fuel = factor(fuel, c("coal", "diesel", "gas", "biogas", "biomass", "solar", "solar floating", "wind", "hydro (small)","geothermal", "msw", "wasteheat", "iew", "total"))) %>% 
  ggplot(aes(x = year, y = vspp_gwh, group = fuel, color = fuel)) +
  geom_line(show.legend = FALSE)+
  facet_wrap(~fuel, 
             scales = "free_y",
             labeller = as_labeller(c(coal = "Coal",
                                      diesel = "Diesel",
                                      gas = "Gas",
                                      biogas = "Biogas",
                                      biomass = "Biomass",
                                      solar = "Solar",
                                      "solar floating" = "Solar floating",
                                      wind = "Wind",
                                      "hydro (small)" = "Small hydro",
                                      geothermal = "Geothermal",
                                      msw = "MSW",
                                      wasteheat = "Waste heat",
                                      iew = "Ind. waste",
                                      total = "Total cont. cap.")))+
  ThemeLine +
  scale_x_discrete(breaks = c(2022,2025,2030,2037))+
  scale_y_continuous(labels =  comma)+ # Add comma to number in y axis
  labs(x = NULL,
       y = "Electricity generation (GWh)")
```

## Merge existing VSPPs and PDP2018 Rev.1

Total electricity generation from Existing VSPPs is selected from 2019 onwards (see section \@ref(totVSPPely) and figure \@ref(fig:plot-totvspp-ene-2015-2021)). The R code chunk is given below. 

```{r merge_vspp_ext, echo=TRUE, warning=FALSE, message=FALSE}
merge_vspp_ext <- 
  
tot_vspp_ext %>% 
  filter(vspp == "tot_vspp_ext_gwh",
         year >= 2019) %>% 
  select(!vspp)
```

Total electricity generation from VSPPs in PDP2018 Rev.1 is selected from 2022 onwards (see section \@ref(vsppenergyPDP2018R1) and figure \@ref(fig:plot-vsppEnePDP2018r1)). The R code chunk is given below.

```{r merge_vspp_pdp2018r1, echo=TRUE, warning=FALSE, message=FALSE}
merge_vspp_pdp2018r1 <-
  
vsppenergyPDP2018R1 %>% 
  filter(fuel =="total",
         year >= 2022) %>% 
  select(!fuel)
```

The R code chunk below combines 2 data frames above. The `full_join` [function](https://dplyr.tidyverse.org/reference/mutate-joins.html) is used. The function belongs to `dplyr` package which is a subset of `tidyverse` package (see section \@ref(packset)). Figure \@ref(fig:plot-merge-vspp-ext-pdp) illustrates total electricity generation from VSPPs in the PDP2018 Rev.1. 

```{r merge_vspp_ext_pdp, echo=TRUE, warning=FALSE, message=TRUE}
merge_vspp_ext_pdp <-
  full_join(merge_vspp_ext,
          merge_vspp_pdp2018r1,
          by = c("ene_vspp_ext_gwh" = "vspp_gwh"))
```

```{r plot-merge-vspp-ext-pdp, echo=FALSE, warning=FALSE, message=FALSE, fig.cap='Total electricity generation from VSPPs in PDP2018 Rev.1', fig.align='center', out.width= '90%'}
ggplotly(
  merge_vspp_ext_pdp %>% 
  select(ene_vspp_ext_gwh) %>% 
  mutate(year = c(2019:2037)) %>% 
  ggplot(aes(x = year, y = ene_vspp_ext_gwh,  color = "red")) +
  geom_line(show.legend = FALSE)+
  geom_point(show.legend = FALSE)+
  ThemeLine+
  scale_x_continuous(breaks = c(2019, 2025, 2030, 2037))+
  scale_y_continuous(limits = c(0,80000),
                     breaks = seq(0,80000, 10000),
                     labels = comma)+
  labs(x = NULL,
       y = "Electricity generation (GWh)")
)
```




