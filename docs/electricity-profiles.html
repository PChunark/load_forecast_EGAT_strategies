<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Electricity profiles | An Electricity Profiles</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Electricity profiles | An Electricity Profiles" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Electricity profiles | An Electricity Profiles" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Puttipong Chunark, Ph.D." />


<meta name="date" content="2023-06-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="parts.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An electricity profiles Book </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="electricity-profiles.html"><a href="electricity-profiles.html"><i class="fa fa-check"></i><b>2</b> Electricity profiles</a>
<ul>
<li class="chapter" data-level="2.1" data-path="electricity-profiles.html"><a href="electricity-profiles.html#initial-settings"><i class="fa fa-check"></i><b>2.1</b> Initial settings</a></li>
<li class="chapter" data-level="2.2" data-path="electricity-profiles.html"><a href="electricity-profiles.html#the-egat-electrity-sale-profile-to-mea"><i class="fa fa-check"></i><b>2.2</b> The EGAT electrity sale profile to MEA</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="parts.html"><a href="parts.html"><i class="fa fa-check"></i><b>3</b> Parts</a></li>
<li class="chapter" data-level="4" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html"><i class="fa fa-check"></i><b>4</b> Footnotes and citations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#footnotes"><i class="fa fa-check"></i><b>4.1</b> Footnotes</a></li>
<li class="chapter" data-level="4.2" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#citations"><i class="fa fa-check"></i><b>4.2</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>5</b> Blocks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="blocks.html"><a href="blocks.html#equations"><i class="fa fa-check"></i><b>5.1</b> Equations</a></li>
<li class="chapter" data-level="5.2" data-path="blocks.html"><a href="blocks.html#theorems-and-proofs"><i class="fa fa-check"></i><b>5.2</b> Theorems and proofs</a></li>
<li class="chapter" data-level="5.3" data-path="blocks.html"><a href="blocks.html#callout-blocks"><i class="fa fa-check"></i><b>5.3</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sharing-your-book.html"><a href="sharing-your-book.html"><i class="fa fa-check"></i><b>6</b> Sharing your book</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sharing-your-book.html"><a href="sharing-your-book.html#publishing"><i class="fa fa-check"></i><b>6.1</b> Publishing</a></li>
<li class="chapter" data-level="6.2" data-path="sharing-your-book.html"><a href="sharing-your-book.html#pages"><i class="fa fa-check"></i><b>6.2</b> 404 pages</a></li>
<li class="chapter" data-level="6.3" data-path="sharing-your-book.html"><a href="sharing-your-book.html#metadata-for-sharing"><i class="fa fa-check"></i><b>6.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Electricity Profiles</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="electricity-profiles" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Electricity profiles<a href="electricity-profiles.html#electricity-profiles" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter provides electricity profiles and a R coding technique.
Electricity profiles are illustrated to give an insight into profile behavior.
R coding technique are given in order to understand the process flow and
manage the big data obtained from several sources in the organization.</p>
<div id="initial-settings" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Initial settings<a href="electricity-profiles.html#initial-settings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before the project starts, library are required as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="electricity-profiles.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#For data manipulation</span></span>
<span id="cb1-2"><a href="electricity-profiles.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co">#For reading the excel sheet</span></span>
<span id="cb1-3"><a href="electricity-profiles.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-4"><a href="electricity-profiles.html#cb1-4" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-5"><a href="electricity-profiles.html#cb1-5" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div>
<p>Design a theme and lines for figures</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="electricity-profiles.html#cb2-1" tabindex="-1"></a>ThemeLine <span class="ot">&lt;-</span> </span>
<span id="cb2-2"><a href="electricity-profiles.html#cb2-2" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb2-3"><a href="electricity-profiles.html#cb2-3" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb2-4"><a href="electricity-profiles.html#cb2-4" tabindex="-1"></a>    <span class="at">panel.border=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb2-5"><a href="electricity-profiles.html#cb2-5" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="cn">NA</span>), </span>
<span id="cb2-6"><a href="electricity-profiles.html#cb2-6" tabindex="-1"></a>    <span class="co">#    axis.title=element_text(size=5),</span></span>
<span id="cb2-7"><a href="electricity-profiles.html#cb2-7" tabindex="-1"></a>    <span class="co">#    axis.text.x = element_text(hjust=1,size = 10, angle = 0),</span></span>
<span id="cb2-8"><a href="electricity-profiles.html#cb2-8" tabindex="-1"></a>    <span class="at">axis.line=</span><span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb2-9"><a href="electricity-profiles.html#cb2-9" tabindex="-1"></a>    <span class="at">panel.background=</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb2-10"><a href="electricity-profiles.html#cb2-10" tabindex="-1"></a>    <span class="at">panel.grid.major.x=</span><span class="fu">element_line</span>(<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,<span class="at">colour=</span><span class="st">&quot;grey&quot;</span>,<span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb2-11"><a href="electricity-profiles.html#cb2-11" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-12"><a href="electricity-profiles.html#cb2-12" tabindex="-1"></a>    <span class="co"># panel.grid.major=element_blank(),</span></span>
<span id="cb2-13"><a href="electricity-profiles.html#cb2-13" tabindex="-1"></a>    <span class="at">strip.background=</span><span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>, <span class="at">colour=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb2-14"><a href="electricity-profiles.html#cb2-14" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle =</span> <span class="dv">0</span>,<span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb2-15"><a href="electricity-profiles.html#cb2-15" tabindex="-1"></a>    <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>,<span class="at">angle=</span><span class="dv">45</span>, <span class="at">vjust=</span><span class="fl">0.9</span>, <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="at">t =</span> <span class="fl">0.3</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>), <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb2-16"><a href="electricity-profiles.html#cb2-16" tabindex="-1"></a>    <span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>,<span class="at">margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="fl">0.3</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>), <span class="st">&quot;cm&quot;</span>)),</span>
<span id="cb2-17"><a href="electricity-profiles.html#cb2-17" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb2-18"><a href="electricity-profiles.html#cb2-18" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb2-19"><a href="electricity-profiles.html#cb2-19" tabindex="-1"></a>    <span class="at">axis.ticks.length=</span><span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.15</span>,<span class="st">&quot;cm&quot;</span>)</span>
<span id="cb2-20"><a href="electricity-profiles.html#cb2-20" tabindex="-1"></a>  )</span>
<span id="cb2-21"><a href="electricity-profiles.html#cb2-21" tabindex="-1"></a>linepalette1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#4DAF4A&quot;</span>,<span class="st">&quot;#FF7F00&quot;</span>,<span class="st">&quot;#377EB8&quot;</span>,<span class="st">&quot;#E41A1C&quot;</span>,<span class="st">&quot;#984EA3&quot;</span>,<span class="st">&quot;#F781BF&quot;</span>,<span class="st">&quot;#8DD3C7&quot;</span>,<span class="st">&quot;#FB8072&quot;</span>,<span class="st">&quot;#80B1D3&quot;</span>,<span class="st">&quot;#FDB462&quot;</span>,<span class="st">&quot;#B3DE69&quot;</span>,<span class="st">&quot;#FCCDE5&quot;</span>,<span class="st">&quot;#D9D9D9&quot;</span>,<span class="st">&quot;#BC80BD&quot;</span>,<span class="st">&quot;#CCEBC5&quot;</span>,<span class="st">&quot;#FFED6F&quot;</span>,<span class="st">&quot;#7f878f&quot;</span>,<span class="st">&quot;#A65628&quot;</span>,<span class="st">&quot;#FFFF33&quot;</span>)</span>
<span id="cb2-22"><a href="electricity-profiles.html#cb2-22" tabindex="-1"></a>linepalette2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#E41A1C&quot;</span>,<span class="st">&quot;#FF7F00&quot;</span>,<span class="st">&quot;#377EB8&quot;</span>,<span class="st">&quot;#B3DE69&quot;</span>,<span class="st">&quot;#4DAF4A&quot;</span>,<span class="st">&quot;#984EA3&quot;</span>,<span class="st">&quot;#F781BF&quot;</span>,<span class="st">&quot;#8DD3C7&quot;</span>,<span class="st">&quot;#FB8072&quot;</span>,<span class="st">&quot;#80B1D3&quot;</span>,<span class="st">&quot;#FDB462&quot;</span>,<span class="st">&quot;#FCCDE5&quot;</span>,<span class="st">&quot;#D9D9D9&quot;</span>,<span class="st">&quot;#BC80BD&quot;</span>,<span class="st">&quot;#CCEBC5&quot;</span>,<span class="st">&quot;#FFED6F&quot;</span>,<span class="st">&quot;#7f878f&quot;</span>,<span class="st">&quot;#A65628&quot;</span>,<span class="st">&quot;#FFFF33&quot;</span>)</span></code></pre></div>
<p>Create list to store variable</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="electricity-profiles.html#cb3-1" tabindex="-1"></a><span class="co">#----- Make a list of profile to store data -----####</span></span>
<span id="cb3-2"><a href="electricity-profiles.html#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="electricity-profiles.html#cb3-3" tabindex="-1"></a>profiledata <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-4"><a href="electricity-profiles.html#cb3-4" tabindex="-1"></a>profilefigure <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-5"><a href="electricity-profiles.html#cb3-5" tabindex="-1"></a>summarydata <span class="ot">&lt;-</span> <span class="fu">list</span>()</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="electricity-profiles.html#cb4-1" tabindex="-1"></a><span class="co">#----- Make variable for output directory -----####</span></span>
<span id="cb4-2"><a href="electricity-profiles.html#cb4-2" tabindex="-1"></a>outfigdir <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;figures/&quot;</span>)</span></code></pre></div>
</div>
<div id="the-egat-electrity-sale-profile-to-mea" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> The EGAT electrity sale profile to MEA<a href="electricity-profiles.html#the-egat-electrity-sale-profile-to-mea" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The electricity sale profile from EGAT to MEA is given by the Power System Control and Operation Division (ฝ่ายควบคุมระบบกำลังไฟฟ้า).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="electricity-profiles.html#cb5-1" tabindex="-1"></a><span class="co">#----- The 2019 MEA EGAT sale profile ----####</span></span>
<span id="cb5-2"><a href="electricity-profiles.html#cb5-2" tabindex="-1"></a><span class="co"># Profile data ####</span></span>
<span id="cb5-3"><a href="electricity-profiles.html#cb5-3" tabindex="-1"></a>profile <span class="ot">&lt;-</span> </span>
<span id="cb5-4"><a href="electricity-profiles.html#cb5-4" tabindex="-1"></a>  <span class="fu">read_excel</span>(<span class="st">&quot;raw_data/raw_data_profiles/02_Hourly Sale_NetGen_2019.xlsx&quot;</span>,</span>
<span id="cb5-5"><a href="electricity-profiles.html#cb5-5" tabindex="-1"></a>           <span class="at">sheet =</span> <span class="st">&quot;Load Curve&quot;</span>,</span>
<span id="cb5-6"><a href="electricity-profiles.html#cb5-6" tabindex="-1"></a>           <span class="at">range =</span> <span class="st">&quot;C3:D17523&quot;</span></span>
<span id="cb5-7"><a href="electricity-profiles.html#cb5-7" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="electricity-profiles.html#cb5-8" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">datetime =</span> <span class="st">`</span><span class="at">Date/Time</span><span class="st">`</span>, MEA) <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="electricity-profiles.html#cb5-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">date</span>(datetime),</span>
<span id="cb5-10"><a href="electricity-profiles.html#cb5-10" tabindex="-1"></a>         <span class="at">time =</span> <span class="fu">format</span>(<span class="fu">as.POSIXct</span>(datetime),<span class="st">&quot;%H:%M:%S&quot;</span>),</span>
<span id="cb5-11"><a href="electricity-profiles.html#cb5-11" tabindex="-1"></a>         <span class="at">year =</span> <span class="fu">year</span>(datetime),</span>
<span id="cb5-12"><a href="electricity-profiles.html#cb5-12" tabindex="-1"></a>         <span class="at">month =</span> <span class="fu">month</span>(datetime),</span>
<span id="cb5-13"><a href="electricity-profiles.html#cb5-13" tabindex="-1"></a>         <span class="at">day =</span> <span class="fu">day</span>(datetime)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-14"><a href="electricity-profiles.html#cb5-14" tabindex="-1"></a>  <span class="fu">select</span>(datetime, date, time, year, month, day, MEA)</span>
<span id="cb5-15"><a href="electricity-profiles.html#cb5-15" tabindex="-1"></a>profile</span></code></pre></div>
<pre><code>## # A tibble: 17,520 × 7
##    datetime            date       time      year month   day   MEA
##    &lt;dttm&gt;              &lt;date&gt;     &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
##  1 2019-01-01 00:00:00 2019-01-01 00:00:00  2019     1     1 3361.
##  2 2019-01-01 00:30:00 2019-01-01 00:30:00  2019     1     1 3244.
##  3 2019-01-01 01:00:00 2019-01-01 01:00:00  2019     1     1 3200.
##  4 2019-01-01 01:30:00 2019-01-01 01:30:00  2019     1     1 3153.
##  5 2019-01-01 02:00:00 2019-01-01 02:00:00  2019     1     1 3086.
##  6 2019-01-01 02:30:00 2019-01-01 02:30:00  2019     1     1 3005.
##  7 2019-01-01 03:00:00 2019-01-01 03:00:00  2019     1     1 2929.
##  8 2019-01-01 03:30:00 2019-01-01 03:30:00  2019     1     1 2858.
##  9 2019-01-01 04:00:00 2019-01-01 04:00:00  2019     1     1 2801.
## 10 2019-01-01 04:30:00 2019-01-01 04:30:00  2019     1     1 2760.
## # ℹ 17,510 more rows</code></pre>
<p>Calculate the peak, minimun in the unit of MW, and electricity sale to MEA in GWh from the profile.
The electricity sale to MEA (in GWh) is calculated by the summation of profile in MW divided by 2000.</p>
<p>The reason that divided by <strong>2000</strong> is the profile is given a time stamp in <strong>every 30-min</strong>. There are <strong>17520</strong> values. Therefore, the summation of profile is divided by <strong>2</strong> to get the results in <strong>every 1 hr</strong>. We divided the output again by <strong>1000</strong> to convert the unit <strong>from MWh to GWh</strong>.
<span class="math display">\[ Ene_{i/2}=\frac{\sum_{i=1}^{17520} (profile_{i})}{2*1000}\]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="electricity-profiles.html#cb7-1" tabindex="-1"></a><span class="co"># Summary data ####</span></span>
<span id="cb7-2"><a href="electricity-profiles.html#cb7-2" tabindex="-1"></a>maxv <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">max</span>(profile<span class="sc">$</span>MEA)) <span class="co"># Get a peak MW</span></span>
<span id="cb7-3"><a href="electricity-profiles.html#cb7-3" tabindex="-1"></a>minv <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">min</span>(profile<span class="sc">$</span>MEA)) <span class="co"># Get a min MW</span></span>
<span id="cb7-4"><a href="electricity-profiles.html#cb7-4" tabindex="-1"></a>energy <span class="ot">&lt;-</span> <span class="fu">sum</span>(profile<span class="sc">$</span>MEA)<span class="sc">/</span><span class="dv">2000</span> <span class="co"># Calculate the energy</span></span></code></pre></div>
<p>The peak and minimum MW days are also needed to assess in order to provide the maximum and minimum a saled electricity from EGAT to MEA.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="electricity-profiles.html#cb8-1" tabindex="-1"></a>peak_day <span class="ot">&lt;-</span> profile <span class="sc">%&gt;%</span> <span class="co">#Find a peak day</span></span>
<span id="cb8-2"><a href="electricity-profiles.html#cb8-2" tabindex="-1"></a>            <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="electricity-profiles.html#cb8-3" tabindex="-1"></a>            <span class="fu">filter</span>(MEA <span class="sc">==</span> <span class="fu">max</span>(MEA)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="electricity-profiles.html#cb8-4" tabindex="-1"></a>            <span class="fu">pull</span>(datetime)</span>
<span id="cb8-5"><a href="electricity-profiles.html#cb8-5" tabindex="-1"></a>min_day <span class="ot">&lt;-</span> profile <span class="sc">%&gt;%</span> <span class="co">#Find a peak day</span></span>
<span id="cb8-6"><a href="electricity-profiles.html#cb8-6" tabindex="-1"></a>           <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="electricity-profiles.html#cb8-7" tabindex="-1"></a>           <span class="fu">filter</span>(MEA <span class="sc">==</span> <span class="fu">min</span>(MEA)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="electricity-profiles.html#cb8-8" tabindex="-1"></a>           <span class="fu">pull</span>(datetime)</span></code></pre></div>
<p>Load factor is calculated by the energy divided a maximum energy. A maximum energy is <strong>the peak multiplied by 8760</strong>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="electricity-profiles.html#cb9-1" tabindex="-1"></a>load_factor <span class="ot">&lt;-</span> <span class="fu">percent</span>((energy<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>(maxv<span class="sc">*</span><span class="dv">8760</span>), </span>
<span id="cb9-2"><a href="electricity-profiles.html#cb9-2" tabindex="-1"></a>                       <span class="at">accuracy =</span> <span class="fl">0.01</span>, </span>
<span id="cb9-3"><a href="electricity-profiles.html#cb9-3" tabindex="-1"></a>                       <span class="at">decimal.mark =</span> <span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<p>Create a table to store relevant data.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="electricity-profiles.html#cb10-1" tabindex="-1"></a>summary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">peak_day =</span> peak_day,</span>
<span id="cb10-2"><a href="electricity-profiles.html#cb10-2" tabindex="-1"></a>                  <span class="at">min_day =</span> min_day,</span>
<span id="cb10-3"><a href="electricity-profiles.html#cb10-3" tabindex="-1"></a>                  <span class="at">peak_mw =</span> maxv, </span>
<span id="cb10-4"><a href="electricity-profiles.html#cb10-4" tabindex="-1"></a>                  <span class="at">min_mw =</span> minv, </span>
<span id="cb10-5"><a href="electricity-profiles.html#cb10-5" tabindex="-1"></a>                  <span class="at">energy_gwh =</span> energy,</span>
<span id="cb10-6"><a href="electricity-profiles.html#cb10-6" tabindex="-1"></a>                  <span class="at">load_factor =</span> load_factor) <span class="co"># combine all data in 1 table</span></span></code></pre></div>
<p>In 2019, the electricity sale to MEA by EGAT reached it peak <strong>9,526</strong> MW on <strong>2019-04-25 14:00:00</strong>. The energy (electricity) sale to MEA was <strong>54,939.73</strong> GWh.
The summary of the electricity sale to MEA by EGAT in 2019 is given in Table <a href="electricity-profiles.html#tab:sum-egat-to-mea-2019">2.1</a>.</p>
<table style="width:100%;">
<caption><span id="tab:sum-egat-to-mea-2019">Table 2.1: </span>Summary of EGAT sale to MEA in 2019!</caption>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="10%" />
<col width="8%" />
<col width="14%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">peak_day</th>
<th align="left">min_day</th>
<th align="right">peak_mw</th>
<th align="right">min_mw</th>
<th align="right">energy_gwh</th>
<th align="left">load_factor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2019-04-25 14:00:00</td>
<td align="left">2019-01-01 05:00:00</td>
<td align="right">9526</td>
<td align="right">2748</td>
<td align="right">54939.73</td>
<td align="left">65.84%</td>
</tr>
</tbody>
</table>
<p>The electricity sale profile from EGAT to MEA in 2019 is illustrated (see Figure <a href="electricity-profiles.html#fig:EGAT-sale-to-MEA-2019">2.1</a>).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="electricity-profiles.html#cb11-1" tabindex="-1"></a>profile_plot <span class="ot">&lt;-</span></span>
<span id="cb11-2"><a href="electricity-profiles.html#cb11-2" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb11-3"><a href="electricity-profiles.html#cb11-3" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data=</span>profile, </span>
<span id="cb11-4"><a href="electricity-profiles.html#cb11-4" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> datetime, </span>
<span id="cb11-5"><a href="electricity-profiles.html#cb11-5" tabindex="-1"></a>                  <span class="at">y =</span> MEA,</span>
<span id="cb11-6"><a href="electricity-profiles.html#cb11-6" tabindex="-1"></a>                  <span class="at">group =</span> month,</span>
<span id="cb11-7"><a href="electricity-profiles.html#cb11-7" tabindex="-1"></a>                  <span class="at">color =</span> <span class="fu">as.factor</span>(month)),</span>
<span id="cb11-8"><a href="electricity-profiles.html#cb11-8" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="electricity-profiles.html#cb11-9" tabindex="-1"></a>    ThemeLine <span class="sc">+</span></span>
<span id="cb11-10"><a href="electricity-profiles.html#cb11-10" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb11-11"><a href="electricity-profiles.html#cb11-11" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;EGAT sale to MEA (MW)&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-12"><a href="electricity-profiles.html#cb11-12" tabindex="-1"></a>    <span class="fu">scale_x_datetime</span>(<span class="at">breaks=</span><span class="fu">date_breaks</span>(<span class="st">&quot;1 month&quot;</span>), </span>
<span id="cb11-13"><a href="electricity-profiles.html#cb11-13" tabindex="-1"></a>                     <span class="at">labels=</span><span class="fu">date_format</span>(<span class="st">&quot;%b %y&quot;</span>)) <span class="sc">+</span></span>
<span id="cb11-14"><a href="electricity-profiles.html#cb11-14" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">round</span>(maxv,<span class="sc">-</span><span class="dv">3</span>),<span class="dv">1000</span>),</span>
<span id="cb11-15"><a href="electricity-profiles.html#cb11-15" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">round</span>(maxv, <span class="sc">-</span><span class="dv">3</span>))) <span class="sc">+</span>  </span>
<span id="cb11-16"><a href="electricity-profiles.html#cb11-16" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> linepalette1) <span class="sc">+</span></span>
<span id="cb11-17"><a href="electricity-profiles.html#cb11-17" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>summary,</span>
<span id="cb11-18"><a href="electricity-profiles.html#cb11-18" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> peak_day, <span class="at">y =</span> peak_mw))<span class="sc">+</span></span>
<span id="cb11-19"><a href="electricity-profiles.html#cb11-19" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> summary,</span>
<span id="cb11-20"><a href="electricity-profiles.html#cb11-20" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> peak_day, <span class="at">y =</span> <span class="fu">round</span>(maxv, <span class="sc">-</span><span class="dv">3</span>)),</span>
<span id="cb11-21"><a href="electricity-profiles.html#cb11-21" tabindex="-1"></a>              <span class="at">label =</span> <span class="fu">glue</span>(<span class="st">&quot;Peak {maxv} MW </span><span class="sc">\n</span><span class="st">@ {peak_day}&quot;</span>))<span class="sc">+</span></span>
<span id="cb11-22"><a href="electricity-profiles.html#cb11-22" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data=</span>summary,</span>
<span id="cb11-23"><a href="electricity-profiles.html#cb11-23" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> min_day, <span class="at">y =</span> min_mw))<span class="sc">+</span></span>
<span id="cb11-24"><a href="electricity-profiles.html#cb11-24" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> summary,</span>
<span id="cb11-25"><a href="electricity-profiles.html#cb11-25" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> min_day, <span class="at">y =</span> <span class="fu">round</span>(minv, <span class="sc">-</span><span class="dv">3</span>)),</span>
<span id="cb11-26"><a href="electricity-profiles.html#cb11-26" tabindex="-1"></a>              <span class="at">label =</span> <span class="fu">glue</span>(<span class="st">&quot;Minimum {minv} MW </span><span class="sc">\n</span><span class="st">@ {min_day}&quot;</span>),</span>
<span id="cb11-27"><a href="electricity-profiles.html#cb11-27" tabindex="-1"></a>              <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb11-28"><a href="electricity-profiles.html#cb11-28" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:EGAT-sale-to-MEA-2019"></span>
<img src="electricity-profiles_files/figure-html/EGAT-sale-to-MEA-2019-1.png" alt="EGAT electricity sale profile to MEA in 2019." width="90%" />
<p class="caption">
Figure 2.1: EGAT electricity sale profile to MEA in 2019.
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="parts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-cross-refs.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["electricity profiles.pdf", "electricity profiles.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
