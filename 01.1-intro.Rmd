# Introduction

```{r, library load, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
```

Electricity is one of the key final energy to drive an economy. It is used to provide enduse demands. For instance, charging electric vehicles (EVs), lighting houses, heating water and cooking, driving motors to convey products in industrial processes.

In 2021, an electricity consumption (Final energy consumption) was 201,016 GWh [@dede2021]. Manufacturing industry consumed the highest electricity (see Table \@ref(tab:fnely2019)). It accounted for 39% of total electricity consumption in 2021. Commercial and residential sectors were the second and the third largest electricity consumption. They accounted for 33% and 27%. The rest were mining (0.6%), agriculture (0.2%) and transport sectors (0.1%). 


```{r, fnely2019, echo=FALSE, warning=FALSE, message=FALSE}
knitr::kable(
  tibble(Sector = c("Agriculture", "Mining", "Manufac. industry", "Construction", 
                  "Residential", "Commercial", "Transport (Road)", "Transport (Rail)"),
       "Electricity (GWh)" = c(398, 1279, 78919, "na", 54481, 65718, 1, 220)), 
  caption = "Electricity consumption in 2019",
  booktabs = TRUE
)
```

The electricity generation was 186,699 GWh in 2021. The exported and imported electricity were 33,356 GWh and 1,996 GWh. The electricity losses and own uses were 14,098 GWh and 2,945 GWh. Natural gas combined cycle power plants accounted for 59% of total electricity generation in 2021. Thermal power plants accounted for 30%. Table \@ref(tab:elygen2019) gives the electricity generation by power plant in 2021.

```{r, elygen2019, echo=FALSE, warning=FALSE, message=FALSE}
knitr::kable(
  tibble("Power plant type" = c("Hydro", "Thermal", "Gas turbine", "Combined cycle", 
                  "Diesel", "Gas engine", "Others", "Total"),
       "Electricity (GWh)" = c(4682, 56737, 1318, 110597, 28, 4769, 8568, 186699)), 
  caption = "Electricity generation in 2019",
  booktabs = TRUE
)
```


## Initial settings
### Packages setting
Before the project starts, packages are required as follows:

* A `tidyverse` package is a bunch of packages to handle with a data analysis (for more information click [here](https://www.tidyverse.org/packages/)). It consists of data manipulation and visualization as follows:
  * A `ggplot2` [package](https://ggplot2.tidyverse.org/) is for data visualization.
  * A `dplyr` [package](https://dplyr.tidyverse.org/) is for data manipulation.
  * A `tidyr` [package](https://tidyr.tidyverse.org/) is for data tidying.
  * A `readr` [package](https://readr.tidyverse.org/) is for data import.
  * A `purrr` [package](https://purrr.tidyverse.org/) is for functional programming.
  * A `tibble` [package](https://tibble.tidyverse.org/) is a modern reimagining of the data.frame.
  * A `stringr` [package](https://github.com/tidyverse/stringr) is for strings.
  * A `forcats` [package](https://github.com/tidyverse/forcats) is for factors.
  * A `lubridate` [package](https://github.com/tidyverse/lubridate) is for date and time.
* A `readxl` [package](https://readxl.tidyverse.org/) is used for read data from **Excel** into R.
* A `scales` [package](https://scales.r-lib.org/) is applied to scale plots in the ggplot2 package.
* A `glue` [package](https://glue.tidyverse.org/) interprets strings literal. The package embeds R expressions and inserts into argument string.
* A `knitr` [package](https://github.com/yihui/knitr) is a lightweight API's designed to give users full control of the output without heavy coding work. In this project, the package is used for making a HTML. 

```{r, library setting, results='hide', message=FALSE}
library(tidyverse) #For data manipulation
library(readxl) #For reading the excel sheet
library(scales)
library(glue)
library(knitr)
library(plotly)
```
### Theme setting
Theme and lines for figures are set in a variable named `Themeline` as follows:

* `theme_bw()` [function](https://ggplot2.tidyverse.org/reference/ggtheme.html) provides a black and white theme.
* `theme()` function applied for setting theme and line represented in plots.
* `linepalette1` and `linepalette1` variables set line colors.

```{r, theme setting, results='hide', message=FALSE, warning=FALSE}
ThemeLine <- 
  theme_bw() +
  theme(
    panel.border=element_rect(fill=NA),
    panel.grid.minor = element_line(color = NA), 
    #    axis.title=element_text(size=5),
    #    axis.text.x = element_text(hjust=1,size = 10, angle = 0),
    axis.line=element_line(colour="black"),
    panel.background=element_rect(fill = "white"),
    panel.grid.major.x=element_line(linetype="dashed",colour="grey",linewidth = 0.5),
    panel.grid.major.y = element_blank(),
    # panel.grid.major=element_blank(),
    strip.background=element_rect(fill="white", colour="white"),
    strip.text.x = element_text(size=10, colour = "black", angle = 0,face="bold"),
    axis.text.x=element_text(size = 10,angle=45, vjust=0.9, hjust=1, margin = unit(c(t = 0.3, r = 0, b = 0, l = 0), "cm")),
    axis.text.y=element_text(size = 10,margin = unit(c(t = 0, r = 0.3, b = 0, l = 0), "cm")),
    legend.text = element_text(size = 10),
    legend.title = element_text(size = 10),
    axis.ticks.length=unit(-0.15,"cm")
  )
linepalette1 <- c("#4DAF4A","#FF7F00","#377EB8","#E41A1C","#984EA3","#F781BF","#8DD3C7","#FB8072","#80B1D3","#FDB462","#B3DE69","#FCCDE5","#D9D9D9","#BC80BD","#CCEBC5","#FFED6F","#7f878f","#A65628","#FFFF33")
linepalette2 <- c("#E41A1C","#FF7F00","#377EB8","#B3DE69","#4DAF4A","#984EA3","#F781BF","#8DD3C7","#FB8072","#80B1D3","#FDB462","#FCCDE5","#D9D9D9","#BC80BD","#CCEBC5","#FFED6F","#7f878f","#A65628","#FFFF33")

```
### Directory setting
Lists are create to store variables.

```{r, make list}
#----- Make a list of profile to store data -----####

profiledata <- list()
profilefigure <- list()
summarydata <- list()
```

```{r, variable for output}
#----- Make variable for output directory -----####
outfigdir <- c("figures/")
```